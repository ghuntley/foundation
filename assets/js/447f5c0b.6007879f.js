"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[670],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,f=d["".concat(s,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(f,l(l({ref:t},c),{},{components:n})):a.createElement(f,l({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var u=2;u<o;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5162:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(7294),r=n(6010),o="tabItem_Ymn6";function l(e){var t=e.children,n=e.hidden,l=e.className;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,l),hidden:n},t)}},5488:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(3117),r=n(7294),o=n(6010),l=n(2389),i=n(7392),s=n(7094),u=n(2466),c="tabList__CuJ",p="tabItem_LNqP";function d(e){var t,n,l=e.lazy,d=e.block,m=e.defaultValue,f=e.values,v=e.groupId,h=e.className,g=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),y=null!=f?f:g.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),b=(0,i.l)(y,(function(e,t){return e.value===t.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var k=null===m?m:null!=(t=null!=m?m:null==(n=g.find((function(e){return e.props.default})))?void 0:n.props.value)?t:g[0].props.value;if(null!==k&&!y.some((function(e){return e.value===k})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+k+'" but none of its children has the corresponding value. Available values are: '+y.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var w=(0,s.U)(),S=w.tabGroupChoices,N=w.setTabGroupChoices,O=(0,r.useState)(k),E=O[0],x=O[1],A=[],C=(0,u.o5)().blockElementScrollPositionUntilNextRender;if(null!=v){var T=S[v];null!=T&&T!==E&&y.some((function(e){return e.value===T}))&&x(T)}var I=function(e){var t=e.currentTarget,n=A.indexOf(t),a=y[n].value;a!==E&&(C(t),x(a),null!=v&&N(v,String(a)))},W=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a,r=A.indexOf(e.currentTarget)+1;n=null!=(a=A[r])?a:A[0];break;case"ArrowLeft":var o,l=A.indexOf(e.currentTarget)-1;n=null!=(o=A[l])?o:A[A.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:(0,o.Z)("tabs-container",c)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":d},h)},y.map((function(e){var t=e.value,n=e.label,l=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:E===t?0:-1,"aria-selected":E===t,key:t,ref:function(e){return A.push(e)},onKeyDown:W,onFocus:I,onClick:I},l,{className:(0,o.Z)("tabs__item",p,null==l?void 0:l.className,{"tabs__item--active":E===t})}),null!=n?n:t)}))),l?(0,r.cloneElement)(g.filter((function(e){return e.props.value===E}))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},g.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==E})}))))}function m(e){var t=(0,l.Z)();return r.createElement(d,(0,a.Z)({key:String(t)},e))}},9026:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return c},default:function(){return v},frontMatter:function(){return u},metadata:function(){return p},toc:function(){return m}});var a=n(3117),r=n(102),o=(n(7294),n(3905)),l=n(5488),i=n(5162),s=["components"],u={},c="Deploying to Production",p={unversionedId:"guides/production",id:"guides/production",title:"Deploying to Production",description:"Running your services and servers in a real production environment is no",source:"@site/docs/guides/production.mdx",sourceDirName:"guides",slug:"/guides/production",permalink:"/guides/production",draft:!1,editUrl:"https://github.com/namespacelabs/documentation/tree/main/docs/guides/production.mdx",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Running tests on Git pushes",permalink:"/guides/cicd"},next:{title:"Observability",permalink:"/guides/observability"}},d={},m=[{value:"Deploying to AWS EKS",id:"deploying-to-aws-eks",level:2},{value:"Creating an AWS EKS Cluster",id:"creating-an-aws-eks-cluster",level:3},{value:"Install and Configure the AWS CLI",id:"install-and-configure-the-aws-cli",level:4},{value:"Setting up AWS SSO",id:"setting-up-aws-sso",level:4},{value:"Setting up an AWS CLI profile for a given AWS SSO account",id:"setting-up-an-aws-cli-profile-for-a-given-aws-sso-account",level:4},{value:"Create the EKS Cluster",id:"create-the-eks-cluster",level:4}],f={toc:m};function v(e){var t=e.components,n=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"deploying-to-production"},"Deploying to Production"),(0,o.kt)("p",null,"Running your services and servers in a real production environment is no\ndifferent than what you've experienced so far with development and testing."),(0,o.kt)("p",null,"Although Namespace is provider agnostic, we've optimized the onboarding\nexperience to AWS users."),(0,o.kt)("h2",{id:"deploying-to-aws-eks"},"Deploying to AWS EKS"),(0,o.kt)("p",null,"Before we can deploy your application, you need to let Namespace know which EKS\ncluster to deploy to. This presupposes that you've previously created such a\ncluster (see section below for an example)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ns prepare eks --env=prod --aws_profile={aws_profile_name} {cluster_name}\n")),(0,o.kt)("p",null,"Where"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"{aws_profile_name}")," refers to the locally configured aws CLI profile we should be using."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"{cluster_name}")," is the name of EKS cluster we should deploy to.")),(0,o.kt)("p",null,"After preparing your EKS cluster, you can run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ns deploy --env=prod\n")),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Not production ready")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"We don't yet recommend Namespace for real production use."))),(0,o.kt)("h3",{id:"creating-an-aws-eks-cluster"},"Creating an AWS EKS Cluster"),(0,o.kt)("p",null,"The following is for demonstration purposes and is not an example of a production-ready EKS setup."),(0,o.kt)("h4",{id:"install-and-configure-the-aws-cli"},"Install and Configure the AWS CLI"),(0,o.kt)(l.Z,{mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"Linux x86",label:"Linux x86 (64-bit)",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"\n$ unzip awscliv2.zip\n$ sudo ./aws/install\n'))),(0,o.kt)(i.Z,{value:"Linux ARM",label:"Linux ARM64",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl "https://awscli.amazonaws.com/awscli-exe-linux-aarch64.zip" -o "awscliv2.zip"\n$ unzip awscliv2.zip\n$ sudo ./aws/install\n'))),(0,o.kt)(i.Z,{value:"Mac",label:"Mac",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'$ curl "https://awscli.amazonaws.com/AWSCLIV2.pkg" -o "AWSCLIV2.pkg"\n$ sudo installer -pkg AWSCLIV2.pkg -target /\n')))),(0,o.kt)("h4",{id:"setting-up-aws-sso"},"Setting up AWS SSO"),(0,o.kt)("p",null,"An ",(0,o.kt)("a",{parentName:"p",href:"https://aws.amazon.com/single-sign-on/"},"AWS SSO")," account represents a person with access to a set of\nAWS accounts, where each AWS account is an aggregation of AWS resources. After you login with SSO,\nyou have the opportunity to act as any of the AWS accounts you have access to, either through the management console,\nor using programmatic credentials."),(0,o.kt)("p",null,"It's prudent to note that programmatic access is session based, and the credentials you get in the SSO portal are valid for 12 hours (then they need to be refreshed)."),(0,o.kt)("h4",{id:"setting-up-an-aws-cli-profile-for-a-given-aws-sso-account"},"Setting up an AWS CLI profile for a given AWS SSO account"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'$ aws configure --profile [AWS-PROFILE-NAME] sso\nSSO start URL [None]: https://yourdomain.awsapps.com/start\nSSO Region [None]: eu-west-1\n(...)\nThere are x AWS accounts available to you.\nUsing the account ID 980098925158\nThe only role available to you is: root\nUsing the role name "root"\nCLI default client Region [None]: us-east-2\nCLI default output format [None]:\n...\n')),(0,o.kt)("h4",{id:"create-the-eks-cluster"},"Create the EKS Cluster"),(0,o.kt)("p",null,"Install ",(0,o.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/eks/latest/userguide/eksctl.html"},"eksctl")," if needed."),(0,o.kt)("p",null,"Please ensure that you specify ",(0,o.kt)("em",{parentName:"p"},"--profile ","[AWS-PROFILE-NAME]")," if you have set up an AWS account profile."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'# Create cluster "zerotwo" in the "eu-west-1" region.\n$ eksctl create cluster -n zerotwo -r eu-west-1 --profile [AWS-PROFILE-NAME]\n')))}v.isMDXComponent=!0}}]);